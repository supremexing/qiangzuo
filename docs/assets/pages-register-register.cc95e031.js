import{P as e,L as s,x as o,V as t,z as r,o as a,c as i,w as n,i as u,e as l,l as m,a9 as d,q as p,u as c,j as f,k as g,O as h}from"./index-8c7aba04.js";import{_ as w}from"./uni-match-media.e3ea2999.js";import{_ as b}from"./uni-easyinput.258260fe.js";import{_}from"./uni-forms-item.8a944197.js";import{_ as $}from"./u-pupu-sms-code.29574d19.js";import{_ as x}from"./uni-id-pages-agreements.049e72c6.js";import{_ as j}from"./uni-forms.c0f86fd1.js";import{m as v}from"./login-page.mixin.82f4b752.js";import{_ as S}from"./plugin-vueexport-helper.1b428a4d.js";import"./uni-icons.3895f5ca.js";import"./u-button.161f5a48.js";import"./u-loading-icon.31869a23.js";import"./u-toast.8c1b0b63.js";import"./u-transition.b40777e7.js";import"./uni-popup-dialog.a5bc4865.js";import"./store.43506134.js";const{passwordStrength:k}=e,D={super:/^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[~!@#$%^&*_\-+=`|\\(){}[\]:;"'<>,.?/])[0-9a-zA-Z~!@#$%^&*_\-+=`|\\(){}[\]:;"'<>,.?/]{8,24}$/,strong:/^(?=.*[0-9])(?=.*[a-zA-Z])(?=.*[~!@#$%^&*_\-+=`|\\(){}[\]:;"'<>,.?/])[0-9a-zA-Z~!@#$%^&*_\-+=`|\\(){}[\]:;"'<>,.?/]{8,24}$/,medium:/^(?![0-9]+$)(?![a-zA-Z]+$)(?![~!@#$%^&*_\-+=`|\\(){}[\]:;"'<>,.?/]+$)[0-9a-zA-Z~!@#$%^&*_\-+=`|\\(){}[\]:;"'<>,.?/]{8,24}$/,weak:/^(?=.*[0-9])(?=.*[a-zA-Z])[0-9a-zA-Z~!@#$%^&*_\-+=`|\\(){}[\]:;"'<>,.?/]{6,24}$/},P={normal:{noPwd:"请输入密码",noRePwd:"再次输入密码",rePwdErr:"两次输入密码不一致"},passwordStrengthError:{super:"密码必须包含大小写字母、数字和特殊符号，密码长度必须在8-24位之间",strong:"密码必须包含字母、数字和特殊符号，密码长度必须在8-24位之间",medium:"密码必须为字母、数字和特殊符号任意两种的组合，密码长度必须在8-24位之间",weak:"密码必须包含字母，密码长度必须在6-24位之间"}};function M(e){return!(k&&D[k]&&!new RegExp(D[k]).test(e))||P.passwordStrengthError[k]}const y={mobile:{rules:[{required:!0,errorMessage:"请输入手机号"},{validateFunction:function(e,s,o,t){return/^\d+$/.test(s)||t("手机号只能是纯数字"),!0}}],label:"手机号"},nickname:{rules:[{minLength:3,maxLength:32,errorMessage:"昵称长度在 {minLength} 到 {maxLength} 个字符"},{validateFunction:function(e,s,o,t){return(/^1\d{10}$/.test(s)||/^(\w-*\.*)+@(\w-?)+(\.\w{2,})+$/.test(s))&&t("昵称不能是：手机号或邮箱"),/^\d+$/.test(s)&&t("昵称不能为纯数字"),/[\u4E00-\u9FA5\uF900-\uFA2D]{1,}/.test(s)&&t("昵称不能包含中文"),!0}}],label:"昵称"},...{ERROR:P,validPwd:M,getPwdRules:function(e="password",s="password2"){const o={};return o[e]={rules:[{required:!0,errorMessage:P.normal.noPwd},{validateFunction:function(e,s,o,t){const r=M(s);return!0!==r&&t(r),!0}}]},s&&(o[s]={rules:[{required:!0,errorMessage:P.normal.noRePwd},{validateFunction:function(s,o,t,r){return o!=t[e]&&r(P.normal.rePwdErr),!0}}]}),o}}.getPwdRules()},A=s.importObject("uni-id-co");const C=S({mixins:[v],data:()=>({formData:{username:"",mobile:"",password:"",smsCode:""},rules:y,focusMobile:!0,focusPassword:!1,logo:"/static/logo.png",sms_tips:"获取验证码"}),onReady(){this.$refs.form.setRules(this.rules)},onShow(){document.onkeydown=e=>{var s=e||window.event;s&&13==s.keyCode&&this.submit()}},methods:{submit(){this.$refs.form.validate().then((()=>4!=this.$refs.refSMS.getSMSCode().length?o({title:"请输入短信验证码",icon:"none",duration:1e3}):this.needAgreements&&!this.agree?this.$refs.agreements.popup((()=>{this.submitForm()})):void this.submitForm())).catch((e=>{let s=e[0].key;s=s.replace(s[0],s[0].toUpperCase()),this["focus"+s]=!0}))},submitForm(){this.formData.username=parseInt(this.formData.mobile).toString(32).toUpperCase(),this.formData.smsCode=this.$refs.refSMS.getSMSCode(),A.registerUser(this.formData).then((e=>{this.loginSuccess(e)})).catch((e=>{console.log(e.message,"xxxxxxx")}))},navigateBack(){t()},toLogin(){r({url:"/pages/login/login"})}}},[["render",function(e,s,o,t,r,v){const S=p,k=u,D=c,P=f(g("uni-match-media"),w),M=f(g("uni-easyinput"),b),y=f(g("uni-forms-item"),_),A=f(g("u-pupu-sms-code"),$),C=f(g("uni-id-pages-agreements"),x),F=h,R=f(g("uni-forms"),j);return a(),i(k,{class:"uni-content"},{default:n((()=>[l(P,{"min-width":690},{default:n((()=>[l(k,{class:"login-logo"},{default:n((()=>[l(S,{src:r.logo},null,8,["src"])])),_:1}),l(D,{class:"title title-box"},{default:n((()=>[m("用户名密码注册")])),_:1})])),_:1}),d("br"),l(R,{ref:"form",value:r.formData,rules:r.rules,"validate-trigger":"submit","err-show-type":"toast"},{default:n((()=>[l(y,{name:"mobile",required:""},{default:n((()=>[l(M,{inputBorder:!1,focus:r.focusMobile,onBlur:s[0]||(s[0]=e=>r.focusMobile=!1),class:"input-box",placeholder:"请输入手机号 ( 需先绑定图书馆,见群 )",maxlength:"11",modelValue:r.formData.mobile,"onUpdate:modelValue":s[1]||(s[1]=e=>r.formData.mobile=e),trim:"both"},null,8,["focus","modelValue"])])),_:1}),l(y,{name:"password",modelValue:r.formData.password,"onUpdate:modelValue":s[4]||(s[4]=e=>r.formData.password=e),required:""},{default:n((()=>[l(M,{inputBorder:!1,focus:r.focusPassword,onBlur:s[2]||(s[2]=e=>r.focusPassword=!1),class:"input-box",maxlength:"24",placeholder:"请设置 6-24 位密码",type:"password",modelValue:r.formData.password,"onUpdate:modelValue":s[3]||(s[3]=e=>r.formData.password=e),trim:"both"},null,8,["focus","modelValue"])])),_:1},8,["modelValue"]),l(y,null,{default:n((()=>[l(A,{ref:"refSMS",mobile:r.formData.mobile},null,8,["mobile"])])),_:1}),l(C,{scope:"register",ref:"agreements"},null,512),l(F,{class:"uni-btn",type:"primary",onClick:v.submit},{default:n((()=>[m("注册")])),_:1},8,["onClick"]),l(F,{onClick:v.navigateBack,class:"register-back"},{default:n((()=>[m("返回")])),_:1},8,["onClick"])])),_:1},8,["value","rules"])])),_:1})}],["__scopeId","data-v-a9c5e81d"]]);export{C as default};
